<?xml version="1.0" encoding="UTF-8" standalone="yes"?>
<vdb name="PortfolioExcel" version="1">

    <description>The Portfolio Using Excel VDB</description> 
    <property name="UseConnectorMetadata" value="true" />

    <import-vdb name="Portfolio" version="1" import-data-policies="true"/>
    
   <model name="PersonalValuations">
        <property name="importer.headerRowNumber" value="1"/>
        <property name="importer.ExcelFileName" value="otherholdings.xls"/>
        <source name="excelconnector" translator-name="excel"  connection-jndi-name="java:/excel-file"/>
        <metadata type="DDL"><![CDATA[

SET NAMESPACE 'http://www.teiid.org/translator/excel/2014' AS teiid_excel;

CREATE FOREIGN TABLE Sheet1 (
	ROW_ID integer OPTIONS (SEARCHABLE 'All_Except_Like', "teiid_excel:CELL_NUMBER" 'ROW_ID'),
	ACCOUNT_ID integer OPTIONS (SEARCHABLE 'Unsearchable', "teiid_excel:CELL_NUMBER" '1'),
	PRODUCT_TYPE string OPTIONS (SEARCHABLE 'Unsearchable', "teiid_excel:CELL_NUMBER" '2'),
	PRODUCT_VALUE string OPTIONS (SEARCHABLE 'Unsearchable', "teiid_excel:CELL_NUMBER" '3'),
	CONSTRAINT PK0 PRIMARY KEY(ROW_ID)
) OPTIONS ("teiid_excel:FILE" 'otherholdings.xls', "teiid_excel:FIRST_DATA_ROW_NUMBER" '2');
    
         ]]> </metadata>
    </model> 
    
    <model name="OtherHoldings" type="VIRTUAL">
    	<metadata type="DDL"><![CDATA[
    	
    	        CREATE VIEW PersonalHoldings (
            ACCOUNT_ID integer,
            SSN string,
            STATUS string,
            TYPE string,
            PRODUCT_TYPE string,
            PRODUCT_VALUE bigdecimal
            )
            AS  
               SELECT b.ACCOUNT_ID, b.ssn, b.Status, b.Type, a.PRODUCT_TYPE, CONVERT(PRODUCT_VALUE, bigdecimal) AS PRODUCT_VALUE
                                        FROM PersonalValuations.SHEET1 as A, Accounts.Account as B
                                        where A.ACCOUNT_ID = b.ACCOUNT_ID
     	]]>
   		</metadata>
	</model>  

</vdb>
